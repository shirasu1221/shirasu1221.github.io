<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ã—ã‚‰ã™ã®ã‚µã‚¤ãƒˆ</title>

  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      height: 100vh;
      background: url('https://wallpaper.forfun.com/fetch/e3/e31d4e0667f9ae90b89fa1ea58cb6d7f.jpeg?w=1470&r=0.5625') no-repeat center center;
      background-size: cover;
      overflow: hidden;
    }

    .menu-btn {
      position: fixed;
      left: 20px;
      top: 20px;
      font-size: 26px;
      color: white;
      background: rgba(0,0,0,0.5);
      border: none;
      padding: 10px 14px;
      border-radius: 6px;
      cursor: pointer;
      z-index: 2000;
      user-select: none;
      touch-action: none;
    }

    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 230px;
      height: 100vh;
      background: rgba(20, 25, 35, 0.92);
      color: white;
      padding: 20px;
      box-sizing: border-box;
      transform: translateX(-100%);
      transition: transform 0.4s ease;
      z-index: 1500;
    }

    .sidebar.show {
      transform: translateX(0);
    }

    .sidebar button {
      width: 100%;
      padding: 12px;
      margin-bottom: 10px;
      background: rgba(40, 55, 75, 0.9);
      border: none;
      color: white;
      border-radius: 5px;
      font-size: 15px;
      cursor: pointer;
    }

    .content {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      padding: 20px;
      box-sizing: border-box;
      color: white;
      overflow-y: auto;
      background: rgba(0,0,0,0.55);
      backdrop-filter: blur(4px);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .content.show {
      opacity: 1;
    }

    .back-btn {
      padding: 10px 14px;
      background: rgba(200,30,30,0.9);
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
      margin-bottom: 20px;
    }

    .note {
      font-size: 13px;
      color: #ddd;
      margin-top: 8px;
    }
  </style>
</head>

<body>

  <button class="menu-btn" id="menuBtn">â‰¡</button>

  <div class="sidebar" id="sidebar">
    <h2>ã—ã‚‰ã™</h2>
    <button data-target="page1">IPA ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    <button data-target="page2">IPA ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</button>
    <button data-target="page3">SNS</button>
    <button id="lockedMenuBtn">ğŸ” ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼</button>
    <div class="note">ï¼ˆæ³¨æ„ï¼šã“ã®ä¿è­·ã¯åˆå¿ƒè€…å‘ã‘ã®éš ã—æ©Ÿèƒ½ã§ã™ï¼‰</div>
  </div>

  <div class="content" id="content">
    <button class="back-btn" id="backBtn">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>

    <div id="page1" class="page" style="display:none">
      <h2>IPA ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h2>
      <p><a href="#" style="color:#87b3ff">IPAãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a></p>
    </div>

    <div id="page2" class="page" style="display:none">
      <h2>IPA ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>
      <p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ãƒªãƒ³ã‚¯ã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <div id="page3" class="page" style="display:none">
      <h2>SNS</h2>
      <p>YouTube â†’ <a href="https://youtube.com/@shirasu1221" style="color:#87b3ff">ã—ã‚‰ã™</a></p>
      <p>GitHub â†’ <a href="https://github.com/shirasu1221" style="color:#87b3ff">@shirasu1221</a></p>
    </div>

    <div id="lockedPage" class="page" style="display:none"></div>
  </div>

  <script>
    const menuBtn = document.getElementById("menuBtn");
    const sidebar = document.getElementById("sidebar");
    const content = document.getElementById("content");
    const backBtn = document.getElementById("backBtn");
    const pages = document.querySelectorAll(".page");
    const lockedBtn = document.getElementById("lockedMenuBtn");

    let menuOpen = false;

    menuBtn.onclick = () => {
      if (menuOpen) {
        sidebar.classList.remove("show");
      } else {
        sidebar.classList.add("show");
        content.classList.remove("show");
      }
      menuOpen = !menuOpen;
    };

    document.querySelectorAll('.sidebar button[dataâ€‘target]').forEach(btn => {
      btn.onclick = () => {
        const target = btn.dataset.target;
        pages.forEach(p => p.style.display = 'none');
        document.getElementById(target).style.display = 'block';
        sidebar.classList.remove("show");
        content.classList.add("show");
        menuOpen = false;
      };
    });

    backBtn.onclick = () => {
      content.classList.remove("show");
      sidebar.classList.add("show");
      menuOpen = true;
    };

    // ãƒ‰ãƒ©ãƒƒã‚°
    let dragging = false, offsetX = 0, offsetY = 0;
    function startDrag(e) {
      dragging = true;
      const rect = menuBtn.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      offsetX = clientX - rect.left;
      offsetY = clientY - rect.top;
    }
    function drag(e) {
      if (!dragging) return;
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      menuBtn.style.left = (clientX - offsetX) + "px";
      menuBtn.style.top  = (clientY - offsetY) + "px";
    }
    function endDrag(){ dragging = false; }

    menuBtn.addEventListener("mousedown", startDrag);
    menuBtn.addEventListener("touchstart", startDrag, {passive:false});
    window.addEventListener("mousemove", drag);
    window.addEventListener("touchmove", drag, {passive:false});
    window.addEventListener("mouseup", endDrag);
    window.addEventListener("touchend", endDrag);

    // AESå¾©å·ç”¨ãƒ‡ãƒ¼ã‚¿ï¼ˆä»¥ä¸‹ã‚’ã‚ãªãŸã®æš—å·ãƒ‡ãƒ¼ã‚¿ã«ç½®ãæ›ãˆã¦ãã ã•ã„ï¼‰
    const encryptedBase64 = "ã“ã“ã«æš—å·æ–‡ (Base64)";
    const saltBase64 = "ã“ã“ã« salt (Base64)";
    const ivBase64 = "ã“ã“ã« iv (Base64)";

    function b64ToArrayBuffer(b64) {
      const bin = atob(b64);
      const len = bin.length;
      const bytes = new Uint8Array(len);
      for(let i=0; i<len; i++){
        bytes[i] = bin.charCodeAt(i);
      }
      return bytes.buffer;
    }

    async function decryptAESGCM(password){
      try {
        const salt = b64ToArrayBuffer(saltBase64);
        const iv   = b64ToArrayBuffer(ivBase64);
        const data = b64ToArrayBuffer(encryptedBase64);

        const keyMaterial = await crypto.subtle.importKey(
          "raw",
          new TextEncoder().encode(password),
          {name:"PBKDF2"},
          false,
          ["deriveKey"]
        );

        const key = await crypto.subtle.deriveKey(
          {
            name:"PBKDF2",
            salt: salt,
            iterations: 200000,
            hash: "SHA-256"
          },
          keyMaterial,
          { name: "AES-GCM", length: 256 },
          false,
          ["decrypt"]
        );

        const plain = await crypto.subtle.decrypt(
          { name:"AES-GCM", iv: iv },
          key,
          data
        );

        return new TextDecoder().decode(plain);
      } catch(e){
        return null;
      }
    }

    lockedBtn.onclick = async () => {
      const input = prompt("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š");
      if (!input) return;
      const decrypted = await decryptAESGCM(input);
      if (!decrypted) {
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã†ã‹å¾©å·ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
        return;
      }
      pages.forEach(p => p.style.display='none');
      const lp = document.getElementById("lockedPage");
      lp.innerHTML = decrypted;
      lp.style.display = "block";
      sidebar.classList.remove("show");
      content.classList.add("show");
      menuOpen = false;
    };
  </script>

</body>
</html>
